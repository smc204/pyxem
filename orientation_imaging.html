<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Orientation Mapping &#8212; pyXem 0.5 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Strain Mapping" href="strain_mapping.html" />
    <link rel="prev" title="Post-facto Imaging" href="post_facto_imaging.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          pyXem</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Electron Diffraction - Signal Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="post_facto_imaging.html">Post-facto Imaging</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Orientation Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="strain_mapping.html">Strain Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffraction_simulation.html">Electron Diffraction Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributor Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">pyxem</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Orientation Mapping</a><ul>
<li><a class="reference internal" href="#pattern-matching">Pattern Matching</a><ul>
<li><a class="reference internal" href="#diffraction-library-generation">Diffraction Library Generation</a></li>
<li><a class="reference internal" href="#pattern-matching-metric">Pattern Matching Metric</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="post_facto_imaging.html" title="Previous Chapter: Post-facto Imaging"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Post-facto Imaging</span>
    </a>
  </li>
  <li>
    <a href="strain_mapping.html" title="Next Chapter: Strain Mapping"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Strain Mapping &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/orientation_imaging.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="orientation-mapping">
<h1>Orientation Mapping<a class="headerlink" href="#orientation-mapping" title="Permalink to this headline">¶</a></h1>
<p>Orientation mapping can be achieved in a number of ways based on the acquisition
of numerous electron diffraction patterns in the scanning transmission
electron microscope.</p>
<div class="section" id="pattern-matching">
<h2>Pattern Matching<a class="headerlink" href="#pattern-matching" title="Permalink to this headline">¶</a></h2>
<p>Pattern matching, whereby each diffraction pattern in the 4D-S(P)ED dataset is
compared to a library of pre-computed theoretical templates, has become the most
common method of assigning crystal phase and orientation to each recorded pattern.
The implementation described here follows work by Rauch et al. The steps involved
in achieving successful pattern matching are illustrated below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/indexation_scheme.png"><img alt="_images/indexation_scheme.png" src="_images/indexation_scheme.png" style="width: 600px;" /></a>
</div>
<div class="section" id="diffraction-library-generation">
<h3>Diffraction Library Generation<a class="headerlink" href="#diffraction-library-generation" title="Permalink to this headline">¶</a></h3>
<p>Generating a library of theoretical templates involves specification of the
crystal phases and orientations to be included, followed by simulation of a
template diffraction pattern corresponding to each phase and orientation. Although
it might be appealing to include all known phases and orientations this will
result in a very library generation times. Thus, in practice, it is preferable
to use prior knowledge to limit the template library to a minimal but sufficient
size. For phases, it is usually simple limited to a small number of likely phases
based on previous characterisation. The orientations to be included are most
generally selected as a uniform sampling of symmetry inequivalent orientations
corresponding to the crystallography of the given phases. The symmetry
inequivalence is very important. True uniform sampling of orientation space
requires consideration of the topology of orientation space. Pyxem contains
utility functions, (e.g. - <a href="#id1"><span class="problematic" id="id2">:py:method:`~utils.sim_utils.get_equispaced_so3_grid`</span></a>
to assist in this matter.</p>
<p>E.g. for cubic symmetry:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">orientations</span> <span class="o">=</span> <span class="n">equispaced_so3_grid</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Pre-calculated orientation grids with approximately 1 degree angular resolution
are also available for all proper rotational point groups <a class="reference external" href="https://drive.google.com/open?id=1Xj064eDB9D5drYOuCkdzwZmR5lcCULPG">here</a>.</p>
<p>A structure library can then be constructed containing all the expected phases,
which are defined as PyMatGen structures and corresponding orientations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">structure</span> <span class="o">=</span> <span class="n">pmg</span><span class="o">.</span><span class="n">Structure</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="s1">&#39;ga_as.cif&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure_lib</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure_lib</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">orientations</span><span class="p">)</span>
</pre></div>
</div>
<p>Simulation of template patterns may, in principle, be achieved using any of the
diffraction simulation methods implemented in pyXem. The simulator is set up in
the <a class="reference internal" href="pyxem.generators.html#pyxem.generators.diffraction_generator.DiffractionGenerator" title="pyxem.generators.diffraction_generator.DiffractionGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffractionGenerator</span></code></a> class, for example as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">edc</span> <span class="o">=</span> <span class="n">pxm</span><span class="o">.</span><span class="n">DiffractionGenerator</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mf">5e-2</span><span class="p">)</span>
</pre></div>
</div>
<p>A library of diffraction patterns for all orientations of expected phases can
then be generated using an appropriate <a class="reference internal" href="pyxem.generators.html#pyxem.generators.library_generator.DiffractionLibraryGenerator" title="pyxem.generators.library_generator.DiffractionLibraryGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiffractionLibraryGenerator</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diff_gen</span> <span class="o">=</span> <span class="n">pxm</span><span class="o">.</span><span class="n">DiffractionLibraryGenerator</span><span class="p">(</span><span class="n">edc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">library</span> <span class="o">=</span> <span class="n">diff_gen</span><span class="o">.</span><span class="n">get_diffraction_library</span><span class="p">(</span><span class="n">structure_lib</span><span class="p">,</span>
<span class="go">                                               calibration=recip_cal,</span>
<span class="go">                                               reciprocal_radius=1.,</span>
<span class="go">                                               half_shape=(72,72),</span>
<span class="go">                                               representation=&#39;euler&#39;,</span>
<span class="go">                                               with_direct_beam=False)</span>
</pre></div>
</div>
</div>
<div class="section" id="pattern-matching-metric">
<h3>Pattern Matching Metric<a class="headerlink" href="#pattern-matching-metric" title="Permalink to this headline">¶</a></h3>
<p>The best fitting simulated pattern corresponding to every experimental
diffraction pattern is determined using a <a class="reference internal" href="pyxem.generators.html#pyxem.generators.indexation_generator.IndexationGenerator" title="pyxem.generators.indexation_generator.IndexationGenerator"><code class="xref py py-class docutils literal notranslate"><span class="pre">IndexationGenerator</span></code></a> as
follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indexer</span> <span class="o">=</span> <span class="n">IndexationGenerator</span><span class="p">(</span><span class="n">dp</span><span class="p">,</span> <span class="n">library</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">match_results</span> <span class="o">=</span> <span class="n">indexer</span><span class="o">.</span><span class="n">correlate</span><span class="p">()</span>
</pre></div>
</div>
<p>Once again (this bears repeating) if <code class="code docutils literal notranslate"><span class="pre">dp</span></code> is not a set of centered S(P)ED scans this method will fail
to produce meaningful results in weird and hard to define ways.</p>
<p>The correlation index, Q, used to achieve this matching is defined as:</p>
<div class="math notranslate nohighlight">
\[Q = \frac{\Sigma P(x,y) T(x,y)}{\sqrt[]{\Sigma T^{2}(x,y)}}\]</div>
<p>where P(x,y) is the intensity of the pixel with coordinates (x,y) in the
experimental diffraction pattern and T(x,y) is the intensity of template at
(x,y). Q is evaluated for each template, and the template with the largest value
is considered to be correct for this P.</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright Copyright 2017-2018, Python Crystallographic Electron Microscopy.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.4.<br/>
    </p>
  </div>
</footer>
  </body>
</html>